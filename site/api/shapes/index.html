
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../texturizing/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.45">
    
    
      
        <title>SynthShapes.shapes - SynthShapes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#SynthShapes.shapes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SynthShapes" class="md-header__button md-logo" aria-label="SynthShapes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SynthShapes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SynthShapes.shapes
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SynthShapes" class="md-nav__button md-logo" aria-label="SynthShapes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SynthShapes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SynthShapes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SynthShapes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blending/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SynthShapes.blending
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SynthShapes.filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hist/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SynthShapes.hist
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../texturizing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SynthShapes.texturizing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    SynthShapes.shapes
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    SynthShapes.shapes
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes--overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes--features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobConfig" class="md-nav__link">
    <span class="md-ellipsis">
      MultiLobedBlobConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase" class="md-nav__link">
    <span class="md-ellipsis">
      MultiLobedBlobBase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiLobedBlobBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.sample_axis_lengths" class="md-nav__link">
    <span class="md-ellipsis">
      sample_axis_lengths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.sample_centroid_coords" class="md-nav__link">
    <span class="md-ellipsis">
      sample_centroid_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.check_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      check_overlap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.sample_nonoverlapping_geometries" class="md-nav__link">
    <span class="md-ellipsis">
      sample_nonoverlapping_geometries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.make_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      make_shapes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobSampler" class="md-nav__link">
    <span class="md-ellipsis">
      MultiLobedBlobSampler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiLobedBlobSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobSampler.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobeBlobAugmentation" class="md-nav__link">
    <span class="md-ellipsis">
      MultiLobeBlobAugmentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiLobeBlobAugmentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobeBlobAugmentation.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobBase" class="md-nav__link">
    <span class="md-ellipsis">
      TorusBlobBase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TorusBlobBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobBase.sample_radii" class="md-nav__link">
    <span class="md-ellipsis">
      sample_radii
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobBase.sample_centroid_coords" class="md-nav__link">
    <span class="md-ellipsis">
      sample_centroid_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobBase.check_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      check_overlap
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobSampler" class="md-nav__link">
    <span class="md-ellipsis">
      TorusBlobSampler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TorusBlobSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobSampler.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobAugmentation" class="md-nav__link">
    <span class="md-ellipsis">
      TorusBlobAugmentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TorusBlobAugmentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobAugmentation.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes--overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes--features" class="md-nav__link">
    <span class="md-ellipsis">
      Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobConfig" class="md-nav__link">
    <span class="md-ellipsis">
      MultiLobedBlobConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase" class="md-nav__link">
    <span class="md-ellipsis">
      MultiLobedBlobBase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiLobedBlobBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.sample_axis_lengths" class="md-nav__link">
    <span class="md-ellipsis">
      sample_axis_lengths
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.sample_centroid_coords" class="md-nav__link">
    <span class="md-ellipsis">
      sample_centroid_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.check_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      check_overlap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.sample_nonoverlapping_geometries" class="md-nav__link">
    <span class="md-ellipsis">
      sample_nonoverlapping_geometries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobBase.make_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      make_shapes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobSampler" class="md-nav__link">
    <span class="md-ellipsis">
      MultiLobedBlobSampler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiLobedBlobSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobedBlobSampler.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobeBlobAugmentation" class="md-nav__link">
    <span class="md-ellipsis">
      MultiLobeBlobAugmentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiLobeBlobAugmentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.MultiLobeBlobAugmentation.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobBase" class="md-nav__link">
    <span class="md-ellipsis">
      TorusBlobBase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TorusBlobBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobBase.sample_radii" class="md-nav__link">
    <span class="md-ellipsis">
      sample_radii
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobBase.sample_centroid_coords" class="md-nav__link">
    <span class="md-ellipsis">
      sample_centroid_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobBase.check_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      check_overlap
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobSampler" class="md-nav__link">
    <span class="md-ellipsis">
      TorusBlobSampler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TorusBlobSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobSampler.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobAugmentation" class="md-nav__link">
    <span class="md-ellipsis">
      TorusBlobAugmentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TorusBlobAugmentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#SynthShapes.shapes.TorusBlobAugmentation.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div class="doc doc-object doc-module">



<h1 id="SynthShapes.shapes" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">SynthShapes.shapes</span>


</h1>

    <div class="doc doc-contents first">

        <h3 id="SynthShapes.shapes--overview">Overview</h3>
<p>The <code>SynthShapes.shapes</code> module provides a comprehensive toolkit for generating
geometric shapes and patterns, tailored for synthetic image generation in
biomedical imaging and beyond. This module supports a variety of 2D and 3D
shapes with customizable parameters, enabling users to create realistic and
diverse datasets for machine learning and computer vision applications.</p>
<h3 id="SynthShapes.shapes--features">Features</h3>
<ul>
<li>
<p><strong>Shape Generators</strong>: Includes predefined methods for creating common
geometric shapes like spheres, stars, toroids, rectangles, spheres, and cubes.</p>
</li>
<li>
<p><strong>Customizability</strong>: Allows fine-tuning of parameters such as size, position,
orientation, and intensity for each shape.</p>
</li>
<li>
<p><strong>Multi-shape Compositions</strong>: Supports combining multiple shapes into a
single image for more complex synthetic data.</p>
</li>
<li>
<p><strong>Label Maps</strong>: Since texturized data is synthesized from semantic label
maps, one-hot encoded labels are easily retreived for semantic segmentation
workflows.</p>
</li>
</ul>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="SynthShapes.shapes.MultiLobedBlobConfig" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MultiLobedBlobConfig</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MultiLobedBlobConfig</span><span class="p">(</span>
    <span class="n">axis_length</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="o">.</span><span class="n">make</span><span class="p">(</span>
        <span class="n">make_range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="p">),</span>
    <span class="n">blob_density</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Fixed</span><span class="p">(</span><span class="mf">0.05</span><span class="p">),</span>
    <span class="n">n_blobs</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
    <span class="n">n_lobes</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">sharpness</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">jitter</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="n">return_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Configuration container for MultiLobedBlobBase.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="SynthShapes.shapes.MultiLobedBlobConfig.shape">shape</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Size of the 3D volume (assumed to be cubic). Default is [128, 128, 128].</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>list of int, optional</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="SynthShapes.shapes.MultiLobedBlobConfig.axis_length">axis_length</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Range of the lengths for any given axis of the blob. Default is RandInt(3, 6).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>(<span title="cornucopia.Sampler">Sampler</span>, optional)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="SynthShapes.shapes.MultiLobedBlobConfig.blob_density">blob_density</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Density of blobs in the volume. Default is Fixed(0.05).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>(<span title="cornucopia.Sampler">Sampler</span>, optional)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="SynthShapes.shapes.MultiLobedBlobConfig.n_blobs">n_blobs</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Maximum number of multi-lobed blobs. Default is RandInt(10, 25).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>(<span title="cornucopia.Sampler">Sampler</span>, optional)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="SynthShapes.shapes.MultiLobedBlobConfig.n_lobes">n_lobes</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Sampler range for the number of lobes per blob. Default is RandInt(1, 5).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>(<span title="cornucopia.Sampler">Sampler</span>, optional)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="SynthShapes.shapes.MultiLobedBlobConfig.sharpness">sharpness</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Upper bound for factor controlling the squareness of the blobs.
Note: +5 = mostly squares, 2 &lt; sharpness &lt; 4 = spheres, sharpness &lt; 2 = stars.
Default is Uniform(1, 3).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>(<span title="cornucopia.Sampler">Sampler</span>, optional)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="SynthShapes.shapes.MultiLobedBlobConfig.jitter">jitter</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Maximum amount of jitter/raggedness to apply to the shape. Default is Uniform(0, 0.5).</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>(<span title="cornucopia.Sampler">Sampler</span>, optional)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="SynthShapes.shapes.MultiLobedBlobConfig.device">device</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Device to perform computations on. Default is 'cuda'.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>(str, optional)</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>









  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="SynthShapes.shapes.MultiLobedBlobBase" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MultiLobedBlobBase</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MultiLobedBlobBase</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">MultiLobedBlobConfig</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="torch.nn.Module" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module">Module</a></code></p>


        <p>Base module for multi-lobed blob operations.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration container for blob parameters.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

        <p>Base module for multi-lobed blob operations.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration container for blob parameters.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">MultiLobedBlobConfig</span> <span class="o">=</span> <span class="n">MultiLobedBlobConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base module for multi-lobed blob operations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    config : MultiLobedBlobConfig</span>
<span class="sd">        Configuration container for blob parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MultiLobedBlobBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_label</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.MultiLobedBlobBase.sample_axis_lengths" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sample_axis_lengths</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_axis_lengths</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample the axis lengths for all dimensions of a blob.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>axis_lengths</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Axis lengths of the blob (D, H, W).</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>[int, int, int]</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_axis_lengths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sample the axis lengths for all dimensions of a blob.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    axis_lengths : torch.Tensor[int, int, int]</span>
<span class="sd">        Axis lengths of the blob (D, H, W).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">axis_lengths</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">axis_length</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">axis_length</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">axis_length</span><span class="p">()</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">axis_lengths</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.MultiLobedBlobBase.sample_centroid_coords" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sample_centroid_coords</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_centroid_coords</span><span class="p">(</span><span class="n">axis_lengths</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample the coordinates of the blob's centroid.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>axis_lengths</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Axis lengths of the blob (depth, height, width).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>[int, int, int]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>centroid_coords</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Coordinates of the centroid (depth, height, width).</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code>tuple[int, int, int]</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_centroid_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis_lengths</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sample the coordinates of the blob&#39;s centroid.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis_lengths : torch.Tensor[int, int, int]</span>
<span class="sd">        Axis lengths of the blob (depth, height, width).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    centroid_coords : tuple[int, int, int]</span>
<span class="sd">        Coordinates of the centroid (depth, height, width).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">centroid_coords</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
            <span class="n">axis_lengths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">axis_lengths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
            <span class="n">axis_lengths</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">axis_lengths</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
            <span class="n">axis_lengths</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">axis_lengths</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">centroid_coords</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.MultiLobedBlobBase.check_overlap" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">check_overlap</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_overlap</span><span class="p">(</span>
    <span class="n">axis_lengths</span><span class="p">,</span> <span class="n">centroid_coords</span><span class="p">,</span> <span class="n">axes_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">centers</span><span class="o">=</span><span class="p">[]</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if the newly sampled blob overlaps with existing blobs.</p>
<p>This function computes the euclidean distance between the centroid of
the new blobs and those of the existing blobs. The distance is
compared to the sum of the largest axes of the blob, to ensure it is
larger, ensuring no overlap exists between the blobs.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>axis_lengths</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Axis lengths of the new blob (depth, height, width).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>[int, int, int]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>centroid_coords</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Coordinates of the new blob's centroid (depth, height, width).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>tuple[int, int, int]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axes_list</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A list of tuples representing the lengths of each axis for all
blobs.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>centroid_coords</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A list of tuples representing the coordinates of the centroid of
each existing blob.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis_lengths</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">centroid_coords</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
                  <span class="n">axes_list</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">centers</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the newly sampled blob overlaps with existing blobs.</span>

<span class="sd">    This function computes the euclidean distance between the centroid of</span>
<span class="sd">    the new blobs and those of the existing blobs. The distance is</span>
<span class="sd">    compared to the sum of the largest axes of the blob, to ensure it is</span>
<span class="sd">    larger, ensuring no overlap exists between the blobs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis_lengths : torch.Tensor[int, int, int]</span>
<span class="sd">        Axis lengths of the new blob (depth, height, width).</span>
<span class="sd">    centroid_coords : tuple[int, int, int]</span>
<span class="sd">        Coordinates of the new blob&#39;s centroid (depth, height, width).</span>
<span class="sd">    axes_list : list</span>
<span class="sd">        A list of tuples representing the lengths of each axis for all</span>
<span class="sd">        blobs.</span>
<span class="sd">    centroid_coords : list</span>
<span class="sd">        A list of tuples representing the coordinates of the centroid of</span>
<span class="sd">        each existing blob.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">overlap_exists</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Iterate through all center coordinate and axis length pairs that have</span>
    <span class="c1"># been sampled</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">axes_list</span><span class="p">):</span>
        <span class="c1"># Calculate euclidean distance between the centroid of an existing</span>
        <span class="c1"># blob and this current blob.</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">((</span><span class="n">centroid_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
                         <span class="o">+</span> <span class="p">(</span><span class="n">centroid_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
                         <span class="o">+</span> <span class="p">(</span><span class="n">centroid_coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                         <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Ensure the euclidean distance between centroids is larger than</span>
        <span class="c1"># the sum of the largest axes of both blobs, ensuring no overlap.</span>
        <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">axis_lengths</span><span class="p">):</span>
            <span class="c1"># If the distance is less than sum of largest axes, overlap yes</span>
            <span class="n">overlap_exists</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">overlap_exists</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.MultiLobedBlobBase.sample_nonoverlapping_geometries" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sample_nonoverlapping_geometries</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_nonoverlapping_geometries</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample nonoverlapping bounding boxes by generating list of centers and
axis lengths.</p>
<p>This method creates two lists (center coordinates and axes lengths)
that will be used to describe the bounding boxes for each blob to be
sampled.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>centers</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>List of tuples representing the centroid coordinates for each
bounding box (centroid_coords)</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code>list</code>
                  </span>
                </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axes_list</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>List of tuples representing the length of each 3 axes for each
geometry</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code>list</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_nonoverlapping_geometries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sample nonoverlapping bounding boxes by generating list of centers and</span>
<span class="sd">    axis lengths.</span>

<span class="sd">    This method creates two lists (center coordinates and axes lengths)</span>
<span class="sd">    that will be used to describe the bounding boxes for each blob to be</span>
<span class="sd">    sampled.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    centers : list</span>
<span class="sd">        List of tuples representing the centroid coordinates for each</span>
<span class="sd">        bounding box (centroid_coords)</span>
<span class="sd">    axes_list : list</span>
<span class="sd">        List of tuples representing the length of each 3 axes for each</span>
<span class="sd">        geometry</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># List of center coordinates for existing blobs</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># List of axes lengths for existing blobs</span>
    <span class="n">axes_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Iterate until we get self.n_blobs blobs.</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">centers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_blobs</span><span class="p">():</span>
        <span class="c1"># Sample a tuple of axis lengths.</span>
        <span class="n">axis_lengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_axis_lengths</span><span class="p">()</span>
        <span class="c1"># Sample a tuple of centroid coordinates.</span>
        <span class="n">centroid_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_centroid_coords</span><span class="p">(</span><span class="n">axis_lengths</span><span class="p">)</span>
        <span class="c1"># Check if overlap exists between the newly sampled bounding box</span>
        <span class="c1"># and the existing ones.</span>
        <span class="n">overlap_exists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_overlap</span><span class="p">(</span><span class="n">axis_lengths</span><span class="p">,</span> <span class="n">centroid_coords</span><span class="p">,</span>
                                            <span class="n">axes_list</span><span class="p">,</span> <span class="n">centers</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">overlap_exists</span><span class="p">:</span>
            <span class="n">centers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">centroid_coords</span><span class="p">)</span>
            <span class="n">axes_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">axis_lengths</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">centers</span><span class="p">,</span> <span class="n">axes_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.MultiLobedBlobBase.make_shapes" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">make_shapes</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_shapes</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Make shape labels.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>imprint_tensor</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Blobs with unique integer labels.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>[int]</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make shape labels.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    imprint_tensor : torch.Tensor[int]</span>
<span class="sd">        Blobs with unique integer labels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_blobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">blob_density</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_blobs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_blobs</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_blobs</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_blobs</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_blobs</span>
        <span class="p">)</span>

    <span class="c1"># self.depth, self.height, self.width = self.shape</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">imprint_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
        <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>

    <span class="n">centers</span><span class="p">,</span> <span class="n">axes_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_nonoverlapping_geometries</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">center</span><span class="p">,</span> <span class="n">axes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">axes_list</span><span class="p">):</span>
        <span class="c1"># Make tensor for blob (and all lobes)</span>
        <span class="n">lobe_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="c1"># Make lobes one by one</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">n_lobes</span><span class="p">()):</span>
            <span class="n">lobe_center_shift</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
                <span class="o">-</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="n">shifted_center</span> <span class="o">=</span> <span class="p">(</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">lobe_center_shift</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                              <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">lobe_center_shift</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                              <span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">lobe_center_shift</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">shifted_meshgrid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_meshgrid_origin_at_centroid</span><span class="p">(</span>
                <span class="n">shifted_center</span><span class="p">)</span>
            <span class="n">lobe_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_lobe_prob</span><span class="p">(</span><span class="n">shifted_meshgrid</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
            <span class="n">lobe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_lobe_from_prob</span><span class="p">(</span><span class="n">lobe_prob</span><span class="p">)</span>
            <span class="n">lobe_tensor</span> <span class="o">+=</span> <span class="n">lobe</span>
        <span class="c1"># Add all lobes to imprint tensor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imprint_tensor</span><span class="p">[</span><span class="n">lobe_tensor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lobe_tensor</span><span class="p">[</span><span class="n">lobe_tensor</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">imprint_tensor</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="SynthShapes.shapes.MultiLobedBlobSampler" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MultiLobedBlobSampler</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MultiLobedBlobSampler</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">MultiLobedBlobConfig</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobBase" href="#SynthShapes.shapes.MultiLobedBlobBase">MultiLobedBlobBase</a></code></p>


        <p>PyTorch module to sample multi-lobed blob labels in a 3D tensor.</p>
<p>Inherits from MultiLobedBlobBase.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration container for blob parameters.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

        <p>PyTorch module to sample multi-lobed blob labels in a 3D tensor.</p>
<p>Inherits from MultiLobedBlobBase.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration container for blob parameters.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">MultiLobedBlobConfig</span> <span class="o">=</span> <span class="n">MultiLobedBlobConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PyTorch module to sample multi-lobed blob labels in a 3D tensor.</span>

<span class="sd">    Inherits from MultiLobedBlobBase.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    config : MultiLobedBlobConfig</span>
<span class="sd">        Configuration container for blob parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MultiLobedBlobBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_label</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.MultiLobedBlobSampler.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Apply blob-sampling operation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>shapes</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Blobs with unique integer labels.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.tensor" href="https://pytorch.org/docs/stable/generated/torch.tensor.html#torch.tensor">tensor</a>[int]</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply blob-sampling operation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    shapes : torch.tensor[int]</span>
<span class="sd">        Blobs with unique integer labels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">blob_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_shapes</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">return_mask</span><span class="p">:</span>
        <span class="n">blob_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">blob_labels</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">blob_labels</span><span class="p">,</span> <span class="n">blob_mask</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">blob_labels</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="SynthShapes.shapes.MultiLobeBlobAugmentation" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MultiLobeBlobAugmentation</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">MultiLobeBlobAugmentation</span><span class="p">(</span>
    <span class="n">config</span><span class="o">=</span><span class="n">MultiLobedBlobConfig</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
    <span class="n">intensity_shift</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="n">augmentation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobBase" href="#SynthShapes.shapes.MultiLobedBlobBase">MultiLobedBlobBase</a></code></p>


        <p>PyTorch module to augment 3D data (C, D, H, W) by sampling and
alpha-blending multi-lobed blobs.</p>
<p>Inherits from MultiLobedBlobBase.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration container for blob parameters.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

        <p>PyTorch module to augment 3D data (C, D, H, W) by sampling and
alpha-blending multi-lobed blobs.</p>
<p>MultiLobedBlobBase.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration container for blob parameters.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.MultiLobedBlobConfig" href="#SynthShapes.shapes.MultiLobedBlobConfig">MultiLobedBlobConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">config</span><span class="p">:</span> <span class="n">MultiLobedBlobConfig</span> <span class="o">=</span> <span class="n">MultiLobedBlobConfig</span><span class="p">,</span>
             <span class="n">alpha</span><span class="p">:</span> <span class="n">Sampler</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
             <span class="n">intensity_shift</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
             <span class="n">augmentation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PyTorch module to augment 3D data (C, D, H, W) by sampling and</span>
<span class="sd">    alpha-blending multi-lobed blobs.</span>

<span class="sd">    MultiLobedBlobBase.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    config : MultiLobedBlobConfig</span>
<span class="sd">        Configuration container for blob parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MultiLobedBlobBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_label</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">augmentation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RandomGaussianMixtureTransform</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">augmentation</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intensity_shift</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">intensity_shift</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blender</span> <span class="o">=</span> <span class="n">Blender</span><span class="p">(</span>
        <span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">intensity_shift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intensity_shift</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.MultiLobeBlobAugmentation.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span><span class="n">background_intensities</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Apply blob augmentation to input tensor.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>incoming_tensor</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Background tensor to augment of shape (C, D, H, W)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>[float]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>blended_blobs</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Blobs alpha-blended into background.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>[float]</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">background_intensities</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply blob augmentation to input tensor.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    incoming_tensor : torch.Tensor[float]</span>
<span class="sd">        Background tensor to augment of shape (C, D, H, W)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    blended_blobs : torch.Tensor[float]</span>
<span class="sd">        Blobs alpha-blended into background.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">background_intensities</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">incoming_shape_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_shapes</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">incoming_shape_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">incoming_shape_labels</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span><span class="p">:</span>
        <span class="n">incoming_shape_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span><span class="p">(</span><span class="n">incoming_shape_labels</span><span class="p">)</span>
        <span class="n">incoming_shape_labels</span><span class="p">[</span><span class="o">~</span><span class="n">incoming_shape_mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">blended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blender</span><span class="p">(</span>
        <span class="n">incoming_shape_labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
        <span class="n">background_intensities</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
        <span class="n">incoming_shape_mask</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">return_mask</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">blended</span><span class="p">,</span> <span class="n">incoming_shape_mask</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">blended</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="SynthShapes.shapes.TorusBlobBase" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TorusBlobBase</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TorusBlobBase</span><span class="p">(</span>
    <span class="n">major_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="n">minor_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="n">n_blobs</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
    <span class="n">jitter</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="torch.nn.Module" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module">Module</a></code></p>


        <p>Base PyTorch module for torus blob operations.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>major_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the major radius of the torus. Default is [10, 20]</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[10, 20]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minor_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the minor radius of the torus. Default is [3, 6].</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[3, 6]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_blobs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum number of tori to generate. Default is 10.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.RandInt">RandInt</span>(10, 25)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jitter</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum amount of jitter to apply to the shape. Default is 0.5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>float</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.Uniform">Uniform</span>(0, 0.5)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Device to run the tensor operations ('cuda' or 'cpu'). Default is
'cuda'.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>str</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;cuda&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Size of the 3D volume (assumed to be cubic). Default is 128.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>128</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

        <p>Base PyTorch module for torus blob operations.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>major_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the major radius of the torus. Default is
[10, 20]</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[10, 20]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minor_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the minor radius of the torus. Default is
[3, 6].</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[3, 6]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_blobs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum number of tori to generate. Default is 10.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.RandInt">RandInt</span>(10, 25)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jitter</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum amount of jitter to apply to the shape. Default is 0.5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>float</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.Uniform">Uniform</span>(0, 0.5)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Device to run the tensor operations ('cuda' or 'cpu'). Default is
'cuda'.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>str</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;cuda&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Size of the 3D volume (assumed to be cubic). Default is 128.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>128</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">major_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">minor_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
             <span class="n">n_blobs</span><span class="p">:</span> <span class="n">Sampler</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
             <span class="n">jitter</span><span class="p">:</span> <span class="n">Sampler</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
             <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base PyTorch module for torus blob operations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    major_radius_range : list of int, optional</span>
<span class="sd">        Range of lengths for the major radius of the torus. Default is</span>
<span class="sd">        [10, 20]</span>
<span class="sd">    minor_radius_range : list of int, optional</span>
<span class="sd">        Range of lengths for the minor radius of the torus. Default is</span>
<span class="sd">        [3, 6].</span>
<span class="sd">    n_blobs : int, optional</span>
<span class="sd">        Maximum number of tori to generate. Default is 10.</span>
<span class="sd">    jitter : float, optional</span>
<span class="sd">        Maximum amount of jitter to apply to the shape. Default is 0.5.</span>
<span class="sd">    device : str, optional</span>
<span class="sd">        Device to run the tensor operations (&#39;cuda&#39; or &#39;cpu&#39;). Default is</span>
<span class="sd">        &#39;cuda&#39;.</span>
<span class="sd">    shape : int, optional</span>
<span class="sd">        Size of the 3D volume (assumed to be cubic). Default is 128.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">TorusBlobBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">major_radius_range</span> <span class="o">=</span> <span class="n">major_radius_range</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">minor_radius_range</span> <span class="o">=</span> <span class="n">minor_radius_range</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">jitter</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">jitter</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_blobs</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_blobs</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">imprint_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                                      <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_label</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.TorusBlobBase.sample_radii" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sample_radii</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_radii</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample the major and minor axes radii.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>major_radius</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The magnitude of the radius of the larger axis.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code>float</code>
                  </span>
                </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>minor_radius</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The magnitude of the radius of the smaller axis.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_radii</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sample the major and minor axes radii.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    major_radius : float</span>
<span class="sd">        The magnitude of the radius of the larger axis.</span>
<span class="sd">    minor_radius</span>
<span class="sd">        The magnitude of the radius of the smaller axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">major_radius</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">major_radius_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">major_radius_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,),</span>
        <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">minor_radius</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minor_radius_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minor_radius_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,),</span>
        <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">major_radius</span><span class="p">,</span> <span class="n">minor_radius</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.TorusBlobBase.sample_centroid_coords" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sample_centroid_coords</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample_centroid_coords</span><span class="p">(</span><span class="n">major_radius</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sample the coordinates of the centroid.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>centroid_coords</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Coordinates of the centroid (depth, height, width).</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code>tuple</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample_centroid_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">major_radius</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sample the coordinates of the centroid.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    centroid_coords : tuple</span>
<span class="sd">        Coordinates of the centroid (depth, height, width).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">centroid_coords</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
            <span class="n">major_radius</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">-</span> <span class="n">major_radius</span><span class="p">,</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
            <span class="n">major_radius</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">major_radius</span><span class="p">,</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span>
            <span class="n">major_radius</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">major_radius</span><span class="p">,</span>
            <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">centroid_coords</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.TorusBlobBase.check_overlap" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">check_overlap</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_overlap</span><span class="p">(</span>
    <span class="n">major_radius</span><span class="p">,</span> <span class="n">centroid_coords</span><span class="p">,</span> <span class="n">radii_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">centers</span><span class="o">=</span><span class="p">[]</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a newly sampled blob overlaps with existing blobs.</p>
<p>This function computes the euclidean distance between the centroid of
a newly sampled blob, and the centroids of previously sampled blobs. It
then checks if the distance is less than the sum of the radii,
indicating an overlap between blobs.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>major_radius</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The radius of the largest dimension of the newly sampled blob.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>float</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>centroid_coords</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Coordinates of the centroid (depth, height, width).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>tuple</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radii_list</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A list of tuples of the radii belonging to blobs that have already
been sampled.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list[float]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>centers</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A list of tuple of the centers belonging to blobs that have already
been sampled.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list[float]</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>overlap_exists</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Whether overlap exists.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code>bool</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">major_radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">centroid_coords</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
                  <span class="n">radii_list</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">centers</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if a newly sampled blob overlaps with existing blobs.</span>

<span class="sd">    This function computes the euclidean distance between the centroid of</span>
<span class="sd">    a newly sampled blob, and the centroids of previously sampled blobs. It</span>
<span class="sd">    then checks if the distance is less than the sum of the radii,</span>
<span class="sd">    indicating an overlap between blobs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    major_radius : float</span>
<span class="sd">        The radius of the largest dimension of the newly sampled blob.</span>
<span class="sd">    centroid_coords : tuple</span>
<span class="sd">        Coordinates of the centroid (depth, height, width).</span>
<span class="sd">    radii_list : list[float]</span>
<span class="sd">        A list of tuples of the radii belonging to blobs that have already</span>
<span class="sd">        been sampled.</span>
<span class="sd">    centers : list[float]</span>
<span class="sd">        A list of tuple of the centers belonging to blobs that have already</span>
<span class="sd">        been sampled.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    overlap_exists : bool</span>
<span class="sd">        Whether overlap exists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">overlap_exists</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Iterate through the centers and radii of all blobs that have been</span>
    <span class="c1"># sampled</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">radii_list</span><span class="p">):</span>
        <span class="c1"># Calculate euclidean distance between the centroids of the</span>
        <span class="c1"># current and existing blobs</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
                <span class="p">(</span><span class="n">centroid_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="o">+</span> <span class="p">(</span><span class="n">centroid_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="o">+</span> <span class="p">(</span><span class="n">centroid_coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="c1"># Compare euclidean distance between centroids to the sum of the</span>
        <span class="c1"># maximum radius of the existing blob and the max radius this blob.</span>
        <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">major_radius</span><span class="p">:</span>
            <span class="c1"># If the distance is less than the sum of radii, overlap exists</span>
            <span class="n">overlap_exists</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">overlap_exists</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="SynthShapes.shapes.TorusBlobSampler" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TorusBlobSampler</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TorusBlobSampler</span><span class="p">(</span>
    <span class="n">major_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="n">minor_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="n">n_blobs</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
    <span class="n">jitter</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
    <span class="n">shape</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">return_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.TorusBlobBase" href="#SynthShapes.shapes.TorusBlobBase">TorusBlobBase</a></code></p>


        <p>PyTorch module to sample torus blob labels in a 3D tensor.</p>
<p>Inherits from TorusBlobBase.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>major_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the major radius of the torus. Default is
[10, 20].</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[10, 20]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minor_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the minor radius of the torus. Default is [3, 6].</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[3, 6]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_blobs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum number of tori to generate. Default is 10.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.RandInt">RandInt</span>(10, 25)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jitter</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum amount of jitter to apply to the shape. Default is 0.5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>float</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.Uniform">Uniform</span>(0, 0.5)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Device to run the tensor operations ('cuda' or 'cpu'). Default is
'cuda'.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>str</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;cuda&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Size of the 3D volume (assumed to be cubic). Default is 128.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>128</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

        <p>PyTorch module to sample torus blob labels in a 3D tensor.</p>
<p>Inherits from TorusBlobBase.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>major_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the major radius of the torus. Default is
[10, 20].</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[10, 20]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minor_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the minor radius of the torus. Default is
[3, 6].</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[3, 6]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_blobs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum number of tori to generate. Default is 10.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.RandInt">RandInt</span>(10, 25)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jitter</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum amount of jitter to apply to the shape. Default is 0.5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>float</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.Uniform">Uniform</span>(0, 0.5)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Device to run the tensor operations ('cuda' or 'cpu'). Default is
'cuda'.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>str</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;cuda&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Size of the 3D volume (assumed to be cubic). Default is 128.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>128</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">major_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">minor_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
             <span class="n">n_blobs</span><span class="p">:</span> <span class="n">Sampler</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
             <span class="n">jitter</span><span class="p">:</span> <span class="n">Sampler</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
             <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
             <span class="n">return_mask</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
             <span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PyTorch module to sample torus blob labels in a 3D tensor.</span>

<span class="sd">    Inherits from TorusBlobBase.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    major_radius_range : list of int, optional</span>
<span class="sd">        Range of lengths for the major radius of the torus. Default is</span>
<span class="sd">        [10, 20].</span>
<span class="sd">    minor_radius_range : list of int, optional</span>
<span class="sd">        Range of lengths for the minor radius of the torus. Default is</span>
<span class="sd">        [3, 6].</span>
<span class="sd">    n_blobs : int, optional</span>
<span class="sd">        Maximum number of tori to generate. Default is 10.</span>
<span class="sd">    jitter : float, optional</span>
<span class="sd">        Maximum amount of jitter to apply to the shape. Default is 0.5.</span>
<span class="sd">    device : str, optional</span>
<span class="sd">        Device to run the tensor operations (&#39;cuda&#39; or &#39;cpu&#39;). Default is</span>
<span class="sd">        &#39;cuda&#39;.</span>
<span class="sd">    shape : int, optional</span>
<span class="sd">        Size of the 3D volume (assumed to be cubic). Default is 128.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">TorusBlobBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">major_radius_range</span> <span class="o">=</span> <span class="n">major_radius_range</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">minor_radius_range</span> <span class="o">=</span> <span class="n">minor_radius_range</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">jitter</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">jitter</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">return_mask</span> <span class="o">=</span> <span class="n">return_mask</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_blobs</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_blobs</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">imprint_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
                                      <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_label</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.TorusBlobSampler.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Apply torus sampling operation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>shapes</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tori with unique integer labels.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>[int]</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply torus sampling operation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    shapes : torch.Tensor[int]</span>
<span class="sd">        Tori with unique integer labels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_shapes</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_mask</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">labels</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mask</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">labels</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="SynthShapes.shapes.TorusBlobAugmentation" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">TorusBlobAugmentation</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">TorusBlobAugmentation</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">major_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="n">minor_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="n">n_blobs</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
    <span class="n">jitter</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="n">return_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
    <span class="n">intensity_shift</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="n">augmentation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SynthShapes.shapes.TorusBlobBase" href="#SynthShapes.shapes.TorusBlobBase">TorusBlobBase</a></code></p>


        <p>A module to augment 3D data (B, C, D, H, W) by sampling and
alpha-blending tori.</p>
<p>Inherits from TorusBlobBase.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>major_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the major radius of the torus. Default is
[10, 20].</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[10, 20]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minor_radius_range</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Range of lengths for the minor radius of the torus. Default is [3, 6].</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>[3, 6]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_blobs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum number of tori to generate. Default is 10.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.RandInt">RandInt</span>(10, 25)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jitter</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum amount of jitter to apply to the shape. Default is 0.5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>float</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="cornucopia.Uniform">Uniform</span>(0, 0.5)</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Device to run the tensor operations ('cuda' or 'cpu'). Default is
'cuda'.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>str</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;cuda&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Size of the 3D volume (assumed to be cubic). Default is 128.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>int</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>128</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">shape</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
             <span class="n">major_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
             <span class="n">minor_radius_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
             <span class="n">n_blobs</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
             <span class="n">jitter</span><span class="p">:</span> <span class="n">Sampler</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
             <span class="n">return_mask</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">alpha</span><span class="p">:</span> <span class="n">Sampler</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
             <span class="n">intensity_shift</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
             <span class="n">augmentation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span>
             <span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">TorusBlobBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A module to augment 3D data (B, C, D, H, W) by sampling and</span>
<span class="sd">    alpha-blending tori.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    major_radius_range : list of int, optional</span>
<span class="sd">        Range of lengths for the major radius of the torus. Default is</span>
<span class="sd">        [10, 20].</span>
<span class="sd">    minor_radius_range : list of int, optional</span>
<span class="sd">        Range of lengths for the minor radius of the torus. Default is</span>
<span class="sd">        [3, 6].</span>
<span class="sd">    n_blobs : int, optional</span>
<span class="sd">        Maximum number of tori to generate. Default is 10.</span>
<span class="sd">    jitter : float, optional</span>
<span class="sd">        Maximum amount of jitter to apply to the shape. Default is 0.5.</span>
<span class="sd">    device : str, optional</span>
<span class="sd">        Device to run the tensor operations (&#39;cuda&#39; or &#39;cpu&#39;). Default is</span>
<span class="sd">        &#39;cuda&#39;.</span>
<span class="sd">    shape : int, optional</span>
<span class="sd">        Size of the 3D volume (assumed to be cubic). Default is 128.</span>
<span class="sd">    alpha : list[float, float]</span>
<span class="sd">        Range of alpha magnitude for alpha blending. Default is</span>
<span class="sd">        [0.25, 0.75]</span>
<span class="sd">    intensity</span>
<span class="sd">    return_mask : bool</span>
<span class="sd">        Optionally return torus mask. Default is False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">major_radius_range</span> <span class="o">=</span> <span class="n">major_radius_range</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">minor_radius_range</span> <span class="o">=</span> <span class="n">minor_radius_range</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_blobs</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RandInt</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_blobs</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">jitter</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">jitter</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">return_mask</span> <span class="o">=</span> <span class="n">return_mask</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">imprint_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_label</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">augmentation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">RandomGaussianMixtureTransform</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span> <span class="o">=</span> <span class="n">augmentation</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intensity_shift</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">Uniform</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">make_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">intensity_shift</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blender</span> <span class="o">=</span> <span class="n">Blender</span><span class="p">(</span>
        <span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span>
        <span class="n">intensity_shift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intensity_shift</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="SynthShapes.shapes.TorusBlobAugmentation.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">forward</span><span class="p">(</span><span class="n">background_intensities</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Apply torus augmentation to input tensor.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>background_intensities</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Background tensor to augment of shape (C, D, H, W)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>[float]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>blended_tori</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tori alpha-blended into background.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-external" title="torch.Tensor" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor">Tensor</a>[float]</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>SynthShapes/shapes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">background_intensities</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply torus augmentation to input tensor.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    background_intensities : torch.Tensor[float]</span>
<span class="sd">        Background tensor to augment of shape (C, D, H, W)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    blended_tori : torch.Tensor[float]</span>
<span class="sd">        Tori alpha-blended into background.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">incoming_shape_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_shapes</span><span class="p">()</span>
    <span class="n">incoming_shape_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">incoming_shape_labels</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span><span class="p">:</span>
        <span class="n">incoming_shape_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">augmentation</span><span class="p">(</span><span class="n">incoming_shape_labels</span><span class="p">)</span>
        <span class="n">incoming_shape_labels</span><span class="p">[</span><span class="o">~</span><span class="n">incoming_shape_mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">blended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blender</span><span class="p">(</span>
        <span class="n">incoming_shape_labels</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
        <span class="n">background_intensities</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span>
        <span class="n">incoming_shape_mask</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_mask</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">blended</span><span class="p">,</span> <span class="n">incoming_shape_mask</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">blended</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>